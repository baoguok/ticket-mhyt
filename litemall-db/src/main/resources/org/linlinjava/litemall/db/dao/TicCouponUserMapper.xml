<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.linlinjava.litemall.db.dao.TicCouponUserMapper" >
  <resultMap id="BaseResultMap" type="org.linlinjava.litemall.db.domain.TicCouponUser" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="cos_id" property="cosId" jdbcType="INTEGER" />
    <result column="cos_user_id" property="cosUserId" jdbcType="INTEGER" />
    <result column="cos_coupon_id" property="cosCouponId" jdbcType="INTEGER" />
    <result column="cos_status" property="cosStatus" jdbcType="SMALLINT" />
    <result column="cos_used_time" property="cosUsedTime" jdbcType="TIMESTAMP" />
    <result column="cos_start_time" property="cosStartTime" jdbcType="TIMESTAMP" />
    <result column="cos_end_time" property="cosEndTime" jdbcType="TIMESTAMP" />
    <result column="cos_order_id" property="cosOrderId" jdbcType="INTEGER" />
    <result column="cos_add_time" property="cosAddTime" jdbcType="TIMESTAMP" />
    <result column="cos_update_time" property="cosUpdateTime" jdbcType="TIMESTAMP" />
    <result column="cos_deleted" property="cosDeleted" jdbcType="BIT" />
  </resultMap>
  
  <resultMap type="org.linlinjava.litemall.db.domain.CustomTicCouAndCos" id="CouAndCos">
  	<id column="cos_id" property="cos.cosId" jdbcType="INTEGER" />
    <result column="cos_user_id" property="cos.cosUserId" jdbcType="INTEGER" />
    <result column="cos_coupon_id" property="cos.cosCouponId" jdbcType="INTEGER" />
    <result column="cos_status" property="cos.cosStatus" jdbcType="SMALLINT" />
    <result column="cos_used_time" property="cos.cosUsedTime" jdbcType="TIMESTAMP" />
    <result column="cos_start_time" property="cos.cosStartTime" jdbcType="TIMESTAMP" />
    <result column="cos_end_time" property="cos.cosEndTime" jdbcType="TIMESTAMP" />
    <result column="cos_order_id" property="cos.cosOrderId" jdbcType="INTEGER" />
    <result column="cos_add_time" property="cos.cosAddTime" jdbcType="TIMESTAMP" />
    <result column="cos_update_time" property="cos.cosUpdateTime" jdbcType="TIMESTAMP" />
    <result column="cos_deleted" property="cos.cosDeleted" jdbcType="BIT" />
  	<result column="cou_id" property="cou.couId" jdbcType="INTEGER" />
    <result column="cou_name" property="cou.couName" jdbcType="VARCHAR" />
    <result column="cou_desc" property="cou.couDesc" jdbcType="VARCHAR" />
    <result column="cou_tag" property="cou.couTag" jdbcType="VARCHAR" />
    <result column="cou_total" property="cou.couTotal" jdbcType="INTEGER" />
    <result column="cou_get_count" property="cou.couGetCount" jdbcType="INTEGER" />
    <result column="cou_discount" property="cou.couDiscount" jdbcType="DECIMAL" />
    <result column="cou_min" property="cou.couMin" jdbcType="DECIMAL" />
    <result column="cou_limit" property="cou.couLimit" jdbcType="SMALLINT" />
    <result column="cou_type" property="cou.couType" jdbcType="SMALLINT" />
    <result column="cou_status" property="cou.couStatus" jdbcType="SMALLINT" />
    <result column="cou_goods_type" property="cou.couGoodsType" jdbcType="SMALLINT" />
    <result column="cou_goods_value" property="cou.couGoodsValue" jdbcType="VARCHAR" typeHandler="org.linlinjava.litemall.db.mybatis.JsonIntegerArrayTypeHandler"/>
    <result column="cou_code" property="cou.couCode" jdbcType="VARCHAR" />
    <result column="cou_time_type" property="cou.couTimeType" jdbcType="SMALLINT" />
    <result column="cou_days" property="cou.couDays" jdbcType="SMALLINT" />
    <result column="cou_start_time" property="cou.couStartTime" jdbcType="TIMESTAMP" />
    <result column="cou_end_time" property="cou.couEndTime" jdbcType="TIMESTAMP" />
    <result column="cou_add_time" property="cou.couAddTime" jdbcType="TIMESTAMP" />
    <result column="cou_update_time" property="cou.couUpdateTime" jdbcType="TIMESTAMP" />
    <result column="cou_deleted" property="cou.couDeleted" jdbcType="BIT" />
  </resultMap>
  <!-- 可使用优惠券 -->
  <select id="MayUseCoupon" resultMap="CouAndCos" parameterType="map">
  	select * from tic_coupon_user as cos left join tic_coupon 
  	as cou on cou.cou_id = cos.cos_coupon_id where
  	cos_user_id = #{userId, jdbcType=INTEGER}
  	and cos.cos_start_time &lt;= #{date, jdbcType=VARCHAR} and cos.cos_end_time &gt;=  #{date, jdbcType=VARCHAR}
  	and cos_status = 0
  </select>
  
  <sql id="Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    cos_id, cos_user_id, cos_coupon_id, cos_status, cos_used_time, cos_start_time, cos_end_time, 
    cos_order_id, cos_add_time, cos_update_time, cos_deleted
  </sql>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="org.linlinjava.litemall.db.domain.TicCouponUserExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from tic_coupon_user
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from tic_coupon_user
    where cos_id = #{cosId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from tic_coupon_user
    where cos_id = #{cosId,jdbcType=INTEGER}
  </delete>
  <delete id="deleteByExample" parameterType="org.linlinjava.litemall.db.domain.TicCouponUserExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from tic_coupon_user
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="org.linlinjava.litemall.db.domain.TicCouponUser" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Integer" keyProperty="cosId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into tic_coupon_user (cos_user_id, cos_coupon_id, cos_status, 
      cos_used_time, cos_start_time, cos_end_time, 
      cos_order_id, cos_add_time, cos_update_time, 
      cos_deleted)
    values (#{cosUserId,jdbcType=INTEGER}, #{cosCouponId,jdbcType=INTEGER}, #{cosStatus,jdbcType=SMALLINT}, 
      #{cosUsedTime,jdbcType=TIMESTAMP}, #{cosStartTime,jdbcType=TIMESTAMP}, #{cosEndTime,jdbcType=TIMESTAMP}, 
      #{cosOrderId,jdbcType=INTEGER}, #{cosAddTime,jdbcType=TIMESTAMP}, #{cosUpdateTime,jdbcType=TIMESTAMP}, 
      #{cosDeleted,jdbcType=BIT})
  </insert>
  <insert id="insertSelective" parameterType="org.linlinjava.litemall.db.domain.TicCouponUser" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey resultType="java.lang.Integer" keyProperty="cosId" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into tic_coupon_user
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="cosUserId != null" >
        cos_user_id,
      </if>
      <if test="cosCouponId != null" >
        cos_coupon_id,
      </if>
      <if test="cosStatus != null" >
        cos_status,
      </if>
      <if test="cosUsedTime != null" >
        cos_used_time,
      </if>
      <if test="cosStartTime != null" >
        cos_start_time,
      </if>
      <if test="cosEndTime != null" >
        cos_end_time,
      </if>
      <if test="cosOrderId != null" >
        cos_order_id,
      </if>
      <if test="cosAddTime != null" >
        cos_add_time,
      </if>
      <if test="cosUpdateTime != null" >
        cos_update_time,
      </if>
      <if test="cosDeleted != null" >
        cos_deleted,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="cosUserId != null" >
        #{cosUserId,jdbcType=INTEGER},
      </if>
      <if test="cosCouponId != null" >
        #{cosCouponId,jdbcType=INTEGER},
      </if>
      <if test="cosStatus != null" >
        #{cosStatus,jdbcType=SMALLINT},
      </if>
      <if test="cosUsedTime != null" >
        #{cosUsedTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosStartTime != null" >
        #{cosStartTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosEndTime != null" >
        #{cosEndTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosOrderId != null" >
        #{cosOrderId,jdbcType=INTEGER},
      </if>
      <if test="cosAddTime != null" >
        #{cosAddTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosUpdateTime != null" >
        #{cosUpdateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosDeleted != null" >
        #{cosDeleted,jdbcType=BIT},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="org.linlinjava.litemall.db.domain.TicCouponUserExample" resultType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select count(*) from tic_coupon_user
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update tic_coupon_user
    <set >
      <if test="record.cosId != null" >
        cos_id = #{record.cosId,jdbcType=INTEGER},
      </if>
      <if test="record.cosUserId != null" >
        cos_user_id = #{record.cosUserId,jdbcType=INTEGER},
      </if>
      <if test="record.cosCouponId != null" >
        cos_coupon_id = #{record.cosCouponId,jdbcType=INTEGER},
      </if>
      <if test="record.cosStatus != null" >
        cos_status = #{record.cosStatus,jdbcType=SMALLINT},
      </if>
      <if test="record.cosUsedTime != null" >
        cos_used_time = #{record.cosUsedTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.cosStartTime != null" >
        cos_start_time = #{record.cosStartTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.cosEndTime != null" >
        cos_end_time = #{record.cosEndTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.cosOrderId != null" >
        cos_order_id = #{record.cosOrderId,jdbcType=INTEGER},
      </if>
      <if test="record.cosAddTime != null" >
        cos_add_time = #{record.cosAddTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.cosUpdateTime != null" >
        cos_update_time = #{record.cosUpdateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.cosDeleted != null" >
        cos_deleted = #{record.cosDeleted,jdbcType=BIT},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update tic_coupon_user
    set cos_id = #{record.cosId,jdbcType=INTEGER},
      cos_user_id = #{record.cosUserId,jdbcType=INTEGER},
      cos_coupon_id = #{record.cosCouponId,jdbcType=INTEGER},
      cos_status = #{record.cosStatus,jdbcType=SMALLINT},
      cos_used_time = #{record.cosUsedTime,jdbcType=TIMESTAMP},
      cos_start_time = #{record.cosStartTime,jdbcType=TIMESTAMP},
      cos_end_time = #{record.cosEndTime,jdbcType=TIMESTAMP},
      cos_order_id = #{record.cosOrderId,jdbcType=INTEGER},
      cos_add_time = #{record.cosAddTime,jdbcType=TIMESTAMP},
      cos_update_time = #{record.cosUpdateTime,jdbcType=TIMESTAMP},
      cos_deleted = #{record.cosDeleted,jdbcType=BIT}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="org.linlinjava.litemall.db.domain.TicCouponUser" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update tic_coupon_user
    <set >
      <if test="cosUserId != null" >
        cos_user_id = #{cosUserId,jdbcType=INTEGER},
      </if>
      <if test="cosCouponId != null" >
        cos_coupon_id = #{cosCouponId,jdbcType=INTEGER},
      </if>
      <if test="cosStatus != null" >
        cos_status = #{cosStatus,jdbcType=SMALLINT},
      </if>
      <if test="cosUsedTime != null" >
        cos_used_time = #{cosUsedTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosStartTime != null" >
        cos_start_time = #{cosStartTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosEndTime != null" >
        cos_end_time = #{cosEndTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosOrderId != null" >
        cos_order_id = #{cosOrderId,jdbcType=INTEGER},
      </if>
      <if test="cosAddTime != null" >
        cos_add_time = #{cosAddTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosUpdateTime != null" >
        cos_update_time = #{cosUpdateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosDeleted != null" >
        cos_deleted = #{cosDeleted,jdbcType=BIT},
      </if>
    </set>
    where cos_id = #{cosId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="org.linlinjava.litemall.db.domain.TicCouponUser" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update tic_coupon_user
    set cos_user_id = #{cosUserId,jdbcType=INTEGER},
      cos_coupon_id = #{cosCouponId,jdbcType=INTEGER},
      cos_status = #{cosStatus,jdbcType=SMALLINT},
      cos_used_time = #{cosUsedTime,jdbcType=TIMESTAMP},
      cos_start_time = #{cosStartTime,jdbcType=TIMESTAMP},
      cos_end_time = #{cosEndTime,jdbcType=TIMESTAMP},
      cos_order_id = #{cosOrderId,jdbcType=INTEGER},
      cos_add_time = #{cosAddTime,jdbcType=TIMESTAMP},
      cos_update_time = #{cosUpdateTime,jdbcType=TIMESTAMP},
      cos_deleted = #{cosDeleted,jdbcType=BIT}
    where cos_id = #{cosId,jdbcType=INTEGER}
  </update>
  <update id="updateSelect" parameterType="org.linlinjava.litemall.db.domain.TicCouponUser">
    update tic_coupon_user
    <set >
      <if test="cosCouponId != null" >
        cos_coupon_id = #{cosCouponId,jdbcType=INTEGER},
      </if>
      <if test="cosStatus != null" >
        cos_status = #{cosStatus,jdbcType=SMALLINT},
      </if>
      <if test="cosUsedTime != null" >
        cos_used_time = #{cosUsedTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosStartTime != null" >
        cos_start_time = #{cosStartTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosEndTime != null" >
        cos_end_time = #{cosEndTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosOrderId != null" >
        cos_order_id = #{cosOrderId,jdbcType=INTEGER},
      </if>
      <if test="cosAddTime != null" >
        cos_add_time = #{cosAddTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosUpdateTime != null" >
        cos_update_time = #{cosUpdateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="cosDeleted != null" >
        cos_deleted = #{cosDeleted,jdbcType=BIT},
      </if>
    </set>
    where cos_user_id = #{cosUserId,jdbcType=INTEGER}
    and cos_id = #{cosId,jdbcType=INTEGER}
  </update>
</mapper>